<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>FaxGwise | Out fax details</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

</head>

<body>

    <div id="wrapper">

    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav" id="side-menu">
                <li class="nav-header">
                    <div class="dropdown profile-element"> <span>
                            <img alt="image" class="img-circle" src="img/profile_small.jpg" />
                             </span>
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="clear"> <span class="block m-t-xs"> <strong class="font-bold">David Williams</strong>
                             </span> <span class="text-muted text-xs block">Art Director <b class="caret"></b></span> </span> </a>
                        <ul class="dropdown-menu animated fadeInRight m-t-xs">
                            <li><a href="profile.html">Profile</a></li>
                            <li><a href="contacts.html">Contacts</a></li>
                            <li><a href="mailbox.html">Mailbox</a></li>
                            <li class="divider"></li>
                            <li><a href="login.html">Logout</a></li>
                        </ul>
                    </div>
                    <div class="logo-element">
                        IN+
                    </div>
                </li>
                <li>
                    <a href="home.html"><i class="fa fa-th-large"></i> <span class="nav-label">Home</span> <span></span></a>
                </li>
                <li class="active">
                    <a href="#"><i class="fa fa-envelope"></i> <span class="nav-label">Faxes</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level">
                        <li><a href="infaxes.html">In faxes</a></li>
                        <li><a href="outfaxes.html">Out faxes</a></li>
                    </ul>
                </li>
                <li>
                    <a href="users.html"><i class="fa fa-user"></i> <span class="nav-label">Users</span> <span></span></a>
                </li>
                <li>
                    <a href="settings.html"><i class="fa fa-cogs"></i> <span class="nav-label">Settings</span> <span></span></a>
                </li>
                <li>
                    <span class="controller-name" class="nav-label">ISDN Controller
                    <span style="margin-left: 10px" class="label label-info">Stopped</span>

                    </span>
                    <a href="settings.html#isdncontroller" id="settings-label" class="glyphicon glyphicon-cog"></a>
                </li>
                <li>
                    <span class="controller-name" class="nav-label">T38 Controller
                    <span style="margin-left: 10px" class="label label-primary">Enabled</span>

                    </span>
                    <a href="settings.html#t38controller" id="settings-label" class="glyphicon glyphicon-cog"></a>
                </li>
                <li>
                    <span class="controller-name" class="nav-label">GW Communicator
                    <span style="margin-left: 10px" class="label label-primary">Enabled</span>

                    </span>
                    <a href="settings.html#gwcommunicator" id="settings-label" class="glyphicon glyphicon-cog"></a>
                </li>
                <li>
                    <span class="controller-name" class="nav-label">Second Communic.
                    <span style="margin-left: 10px" class="label label-info">Stopped</span>

                    </span>
                    <a href="settings.html#secondcommunicator" id="settings-label" class="glyphicon glyphicon-cog"></a>
                </li>
                <li class="landing_link">
                    <a target="_blank" href="Landing_page/index.html"><i class="fa fa-star"></i> <span class="nav-label">Landing Page</span> <span class="label label-warning pull-right">NEW</span></a>
                </li>
                <li class="special_link">
                    <a href="package.html"><i class="fa fa-database"></i> <span class="nav-label">Package</span></a>
                </li>
            </ul>

        </div>
    </nav>

        <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom">
        <nav class="navbar navbar-static-top  " role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
            <form role="search" class="navbar-form-custom" action="http://webapplayers.com/inspinia_admin-v2.0/search_results.html">
                <div class="form-group">
                    <input type="text" placeholder="Search for something..." class="form-control" name="top-search" id="top-search">
                </div>
            </form>
        </div>
            <ul class="nav navbar-top-links navbar-right">
                <li>
                    <span class="m-r-sm text-muted welcome-message">Welcome to INSPINIA+ Admin Theme.</span>
                </li>              

                <li>
                    <a href="../login.html">
                        <i class="fa fa-sign-out"></i> Log out
                    </a>
                </li>
            </ul>

        </nav>
        </div>
            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-sm-4">
                    <h2>Out fax details</h2>
                    <ol class="breadcrumb">
                        <li>
                            <a href="home.html">Home</a>
                        </li>
                        <li>
                            <a href="outfaxes.html">Out faxes</a>
                        </li>
                        
                        <li class="active">
                            <strong>Out fax details</strong>
                        </li>
                    </ol>
                </div>
            </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="wrapper wrapper-content animated fadeInUp">
                    <div class="ibox" ng-app="FaxGWiseApp" ng-controller="outFaxeDetailsCtrl">
                        <div class="ibox-content">
                            <div class="row">
                                <div class="col-lg-12">
                                    <dl class="dl-horizontal">
                                    	<dt>Status:</dt>
                                    	<dd>
                                    		<span ng-if="outFax.FAXSTATE == 'Ok'" class="label label-success">{{outFax.FAXSTATE}}</span>
	                                        <span ng-if="outFax.FAXSTATE == 'Error'" class="label label-danger">{{outFax.FAXSTATE}}</span>
	                                        <span ng-if="outFax.FAXSTATE == 'Unsent'" class="label label-default">{{outFax.FAXSTATE}}</span>
                                            <span ng-if="outFax.FAXSTATE == 'Delay'" class="label label-primary">{{outFax.FAXSTATE}}</span>
                                        </dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt>Subject:</dt> <dd><span>{{outFax.SUBJECT}}</span></dd>
                                    </dl>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-5">
                                    <dl class="dl-horizontal">
                                        <dt>Sender name:</dt> <dd>{{outFax.SENDERNAME}}</dd>
                                        <dt>Sender email:</dt> <dd>{{outFax.SENDEREMAIL}}</dd>
                                        <dt>Sender phone:</dt> <dd>{{outFax.SENDERPHONE}}</dd>
                                        <dt>Sender Fax:</dt> <dd>{{outFax.SENDERFAX}}</dd>
                                        <dt>Sender Company:</dt> <dd>{{outFax.SENDERCOMPANY}}</dd>
                                        <dt>Originator:</dt> <dd>{{outFax.ORIGINATOR}}</dd>
                                    </dl>
                                </div>
                                <div class="col-lg-7" id="cluster_info">
                                    <dl class="dl-horizontal" >

                                        <dt>Created:</dt> <dd>{{formatDate(outFax.CREATIONTIME)}}</dd>
                                        
                                        <dt>Delayed delivery:</dt> <dd>{{formatDate(outFax.DELAYEDDELIVERYTIME)}}</dd>
                                        
                                        <dt>Resolution:</dt> <dd> {{GetResolutionAsText(outFax.RESOLUTION)}} </dd>
                                        <dt>Count of page:</dt> <dd>{{outFax.COUNTOFPAGES}}</dd>
                                        
                                        <dt>Error Report:</dt> 
                                        <dd> 
                                        	<span ng-if="outFax.ERRORREPORT == 0" class="label label-default"><i class="fa fa-times"></i></span>
                                        	<span ng-if="outFax.ERRORREPORT == 1" class="label label-primary"><i class="fa fa-check"></i></span>                                        
                                        </dd>                                                                                
                                                                                                                      
                                        <dt>Send Report:</dt> <dd> {{GetSendReportAsText(outFax.SENDREPORT)}} </dd>
                                    </dl>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <dl class="dl-horizontal">
                                        <dt>From communicator:</dt>
                                        <dd>
                                        	{{outFax.COMMUNICATORNAME}}                              
                                        </dd>
                                    </dl>
                                </div>
                            </div>

                            <div class="modal inmodal fade" id="faxpreview" tabindex="-1" role="dialog"  aria-hidden="true">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                            <!--<h4 class="modal-title">Subject</h4>-->
                                            <!--<small class="font-bold">Subject text.</small>-->
                                        </div>
                                        <div class="modal-body">
											<div class="carousel slide" id="carousel1">
												<div class="carousel-inner">
													<div class="item active">
														<img src="" id="display-img"/>
													</div>

												</div>
												<!--<a data-slide="prev" href="" onclick="prevPic();return false" class="left carousel-control"> <span class="icon-prev"></span> </a>-->
												<!--<a data-slide="next" href="" onclick="nextPic();return false" class="right carousel-control"> <span class="icon-next"></span> </a>-->
											</div>
                            			</div>
                                    </div>
                                </div>
                            </div>
                           

                            <div class="row m-t-sm">
                                <div class="col-lg-12">
                                <div class="panel blank-panel">
                                <div class="panel-heading">
                                <h2>Out Jobs and Tasks</h> 

                                </div>

                                <div class="panel-body">
                                
                                        <table class="table table-striped">
                                        <thead>
                                        <tr>
                                            <th>Job ID</th>
                                            <!--th>Controller</th-->
                                            <th>Create time</th>
                                            <!--th>Send time</th-->
                                            <th>Receiver number</th>
                                            <th>Receiver name</th>
                                            <th>Receiver company</th>
                                            <th>Status</th>
                                            <th></th>
                                        </tr>
                                        </thead>
                                        <tbody ng-repeat="currOutJob in outFax.JOBS">
	                                        <tr class="cursor-pointer" ng-click="openTasks($index)">
	                                            <td>{{currOutJob.ID}}</td>                                            
	                                            <td>{{formatDate(currOutJob.CREATIONTIME)}}</td>
	                                            <td>{{currOutJob.FAX}}</td>
	                                            <td>{{currOutJob.NAME}}</td>
	                                            <td>{{currOutJob.COMPANY}}</td>
	                                            <td>
	                                                <span ng-if="currOutJob.JOBSTATE == 'Error'" class="label label-danger"><i class="fa fa-times"></i> {{currOutJob.JOBSTATE}}</span>
		                                            <span ng-if="currOutJob.JOBSTATE == 'Ok'" class="label label-success"><i class="fa fa-check"></i> {{currOutJob.JOBSTATE}}</span>
		                                            <span ng-if="(currOutJob.JOBSTATE == 'Sending')||(currOutJob.JOBSTATE == 'Unsent')" class="label label-default">{{currOutJob.JOBSTATE}}</span>
	                                            </td>
	                                            <td><a class="faxpreview btn btn-primary btn-sm" id="{{currOutJob.ID}}" data-toggle="modal" data-target="#faxpreview">Preview</a></td>
	                                        </tr>
	                                        <tr data-ng-show="currOutJob.childTableExpanded">
	                                        	<td></td>
	                                        	<td colspan="10">
		                                        	<table class="table table-striped">
			                                        	<thead>
					                                        <tr>
					                                            <th>Task ID</th>
					                                            <th>Controller</th>
					                                            <th>Send time</th>			                                            
					                                            <th>Status</th>
					                                            <th></th>
					                                    	</tr>
					                               		</thead>
					                               		<tbody>
					                               			<tr ng-repeat="currTask in currOutJob.TASKS">
					                               				<td>{{currTask.ID}}</td>
					                               				<td>
					                               					{{currTask.CONTROLLERNAME}}
					                               					<br/>
					                               					<small>{{currTask.CONTROLLERLINES}}</small>
					                               				</td>
					                               				<td>{{currTask.ONLINETIME}} s</td>
					                               				<td>
					                               					<span ng-if="currTask.TASKSTATE == 2" class="label label-danger"><i class="fa fa-times"></i> Error</span>
					                                        		<span ng-if="currTask.TASKSTATE == 1" class="label label-success"><i class="fa fa-check"></i> Success</span>
					                                        		<span ng-if="currTask.TASKSTATE == 0" class="label label-default">Unsent</span>
					                                        		<span ng-if="currTask.TASKSTATE == 3" class="label label-info"><i class="fa fa-trash-o"></i> Cancelled</span>
					                               				</td>
					                               				<td><span class="text-danger">{{currTask.ERRMESSAGE}}</span></td>
					                               			</tr>
					                               		</tbody>
					                               	</table>
				                               	</td>
	                                        </tr>
                                        </tbody>
                                    </table>

                                </div>

                                </div>
                               
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        <div class="footer">
            <div class="pull-right">
                10GB of <strong>250GB</strong> Free.
            </div>
            <div>
                <strong>Copyright</strong> Example Company &copy; 2014-2015
            </div>
        </div>

        </div>
        </div>

    <!-- Mainly scripts -->
    <script src="js/jquery-2.1.1.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="js/inspinia.js"></script>
    <script src="js/plugins/pace/pace.min.js"></script>
    <script src="js/angular.min.js"></script>
    
    <script src="../js/config.js"></script>
	<script src="../js/faxgwise_tools.js"></script>
	<script src="../js/websockets.js"></script>
	<script src="../js/faxgwise.js"></script>
	<script src="../js/slideshow.js"></script>

    <script>
        $(document).ready(function(){

            $('#loading-example-btn').click(function () {
                btn = $(this);
                simpleLoad(btn, true)

                // Ajax example
//                $.ajax().always(function () {
//                    simpleLoad($(this), false)
//                });

                simpleLoad(btn, false)
            });
        });

        function simpleLoad(btn, state) {
            if (state) {
                btn.children().addClass('fa-spin');
                btn.contents().last().replaceWith(" Loading");
            } else {
                setTimeout(function () {
                    btn.children().removeClass('fa-spin');
                    btn.contents().last().replaceWith(" Refresh");
                }, 2000);
            }
        }
    </script>
    <script>
    	var queryStr = parseQueryString(window.location.search);
		InitOutFaxDetails_ngApplication(queryStr['outfaxid']);

		$(document).on("click", ".faxpreview", function() {
		   slideShow.ID = $(this).attr('id');
    	   slideShow.count = 1;
		   slideShow.display(0);
		});

			try
            {
            var socket;                     
            socket = new WebSocket(WEBSOCKET_URL,"synopsejson");     
            console.log('WebSocket - status '+socket.readyState);
            socket.onopen = function(event){
            	Join();
            };
            socket.onmessage = function(event){ 
            };
            socket.onerror   = function(event){ 
            };
            socket.onclose   = function(event){ 
            }
        	}
            catch(ex) {
                console.log(ex);
            } 

            function Join(){
                var msg = JSON.stringify(makerequest("","root/FaxGwiseInfo.Join",[Number(getLocalStorageParam('SESSION_ID')),1]));
                 try{ 
                    socket.send(msg); 
                    console.log('Sent ('+msg.length+" bytes): " + msg.length < 5000 ? msg : (msg.substr(0, 100) + '...')); 
                } catch(ex){ 
                    console.log(ex);
                }
            }

            function makerequest(method,uri,data){
                var req = {
                    request:[method,uri,"",0,"",data]
                };
                 return req;
            }


	</script>
</body>
</html>
